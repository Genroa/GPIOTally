<head>
	<title>GPIOTally</title>
</head>

<body>
	<!-- <nav id="myNavmenu" class="navmenu navmenu-default navmenu-fixed-left offcanvas canvas-slid">
		<a class="navmenu-brand" href="#">Brand</a>
		<ul class="nav navmenu-nav">
			<li class="active"><a href="#">Home</a></li>
			<li><a href="#">Link</a></li>
			<li><a href="#">Link</a></li>
		</ul>
	</nav> -->
	<div class="navbar navbar-default navbar-fixed-top">
		<button type="button" class="navbar-toggle" data-toggle="offcanvas" data-target="#myNavmenu" data-canvas="body">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		</button>
		<span class="navbar-brand">GPIO Tally</span>
	</div>
	{{> grid}}
</body>

<template name="grid">
	<div id="container">
		{{#if Template.subscriptionsReady}}

			<div>{{getInputNumber}} entrées, {{getOutputNumber}} sorties:</div>
			<div>Configuration actuelle : {{getCurrentConfigurationName}}</div>
			<!-- Pour chaque index dans range, générer la colone et les lignes dédiées à cette entrée dans le SVG -->
			<svg id="svgGrid" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1000 {{defineSvgHeight}}" style="height: {{defineSvgHeight}}px">
				{{#each column in inputsRange}}
					<rect class="wire_{{column}}_vert" x="{{columnPosition column}}" y="{{getNameSpace}}" width="{{gridThickness}}" height="{{columnHeight}}" fill="darkgrey"/>
					{{#each line in outputsRange}}
						<rect class="wire_{{column}}_{{line}}" x="{{columnPosition column}}" y="{{columnHeight line}}" width="{{lineLength column}}" height="{{gridThickness}}" fill="darkgrey" stroke="darkgrey"/>
					{{/each}}
				{{/each}}

				<!-- Building connection lines -->
				{{#each column in getCurrentGridConnections}}
					{{#let columnIndex=@index}}
						{{#each out in column}}
							{{#if $eq out 1 }}
								{{{buildConnectionLine columnIndex @index}}}
							{{/if}}
						{{/each}}
					{{/let}}
				{{/each}}
			</svg>
		{{else}}
			Chargement des données...
		{{/if}}
	</div>
</template>
